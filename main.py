import base64
exec(base64.b64decode('ZnJvbSBjb2xvcmFtYSBpbXBvcnQgRm9yZSwgU3R5bGUsIGluaXQKaW1wb3J0IG9zCmltcG9ydCB0aW1lCmltcG9ydCByZXF1ZXN0cwoKaW5pdCgpCgpkZWYgY2xlYXJfY29uc29sZSgpOgogICAgb3Muc3lzdGVtKCdjbHMnIGlmIG9zLm5hbWUgPT0gJ250JyBlbHNlICdjbGVhcicpCgpkZWYgbWFpbigpOgogICAgY2xlYXJfY29uc29sZSgpCiAgICBuaWNrbmFtZSA9IGlucHV0KEZvcmUuR1JFRU4gKyAiTmlja25hbWU6ICIgKyBTdHlsZS5SRVNFVF9BTEwpCiAgICBjbGVhcl9jb25zb2xlKCkKCiAgICBzaXRlcyA9IFsKICAgICAgICAiaHR0cHM6Ly92ay5jb20vIiwKICAgICAgICAiaHR0cHM6Ly9naXRodWIuY29tLyIsCiAgICAgICAgImh0dHBzOi8vbS5vay5ydS8iLAogICAgICAgICJodHRwczovL3lhcHB5Lm1lZGlhL24vIiwKICAgICAgICAiaHR0cHM6Ly93d3cuaW5zdGFncmFtLmNvbS8iLAogICAgICAgICJodHRwczovL3R3aXR0ZXIuY29tLyIsCiAgICAgICAgImh0dHBzOi8vd3d3LmZhY2Vib29rLmNvbS8iLAogICAgXQoKICAgIGZvciBzaXRlIGluIHNpdGVzOgogICAgICAgIHByaW50KEZvcmUuUkVEICsgIlsrXSAiICsgRm9yZS5HUkVFTiArIHNpdGUgKyBGb3JlLllFTExPVyArIGYie25pY2tuYW1lfSIpCiAgICAgICAgdGltZS5zbGVlcCgwLjEpCiAgICAKICAgIHByaW50KCIiKQogICAgaW5wdXQoRm9yZS5SRUQgKyAi0J3QsNC20LzQuNGC0LUgRU5URVIg0YfRgtC+0LHRiyDQv9GA0L7QtNC+0LvQttC40YLRjC4uLiIpCgpkZWYgc2Vjb25kX21ldGhvZCgpOgogICAgY2xlYXJfY29uc29sZSgpCiAgICBuaWNrbmFtZSA9IGlucHV0KEZvcmUuR1JFRU4gKyAiTmlja25hbWU6ICIgKyBTdHlsZS5SRVNFVF9BTEwpCiAgICBjbGVhcl9jb25zb2xlKCkKCiAgICBzaXRlcyA9IFsKICAgICAgICAiaHR0cHM6Ly92ay5jb20vIiwKICAgICAgICAiaHR0cHM6Ly9naXRodWIuY29tLyIsCiAgICAgICAgImh0dHBzOi8vbS5vay5ydS8iLAogICAgICAgICJodHRwczovL3lhcHB5Lm1lZGlhL24vIiwKICAgICAgICAiaHR0cHM6Ly93d3cuaW5zdGFncmFtLmNvbS8iLAogICAgICAgICJodHRwczovL3R3aXR0ZXIuY29tLyIsCiAgICAgICAgImh0dHBzOi8vd3d3LmZhY2Vib29rLmNvbS8iLAogICAgXQoKICAgIGZvciBzaXRlIGluIHNpdGVzOgogICAgICAgIHVybCA9IHNpdGUgKyBuaWNrbmFtZQogICAgICAgIHRyeToKICAgICAgICAgICAgcmVzcG9uc2UgPSByZXF1ZXN0cy5nZXQodXJsKQogICAgICAgICAgICBpZiByZXNwb25zZS5zdGF0dXNfY29kZSA9PSAyMDA6CiAgICAgICAgICAgICAgICBwcmludChGb3JlLlJFRCArICJbK10gIiArIEZvcmUuR1JFRU4gKyBmItCf0YDQvtGE0LjQu9GMINC90LDQudC00LXQvToge3VybH0iKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcHJpbnQoRm9yZS5SRUQgKyAiWy1dICIgKyBGb3JlLkdSRUVOICsgZiLQn9GA0L7RhNC40LvRjCDQvdC1INC90LDQudC00LXQvToge3VybH0iKQogICAgICAgIGV4Y2VwdCByZXF1ZXN0cy5SZXF1ZXN0RXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIHByaW50KEZvcmUuUkVEICsgIlstXSAiICsgRm9yZS5HUkVFTiArIGYi0J7RiNC40LHQutCwINC/0YDQuCDQt9Cw0L/RgNC+0YHQtToge3VybH0iKQogICAgICAgIHRpbWUuc2xlZXAoMC4xKQoKICAgIHByaW50KCIiKQogICAgaW5wdXQoRm9yZS5SRUQgKyAi0J3QsNC20LzQuNGC0LUgRU5URVIg0YfRgtC+0LHRiyDQv9GA0L7QtNC+0LvQttC40YLRjC4uLiIpCgpkZWYgZXhpdF9wcm9ncmFtKCk6CiAgICBjbGVhcl9jb25zb2xlKCkKICAgIGV4aXQoKQoKd2hpbGUgVHJ1ZToKICAgIGNsZWFyX2NvbnNvbGUoKQoKICAgIHByaW50KEZvcmUuUkVEICsgIjEuIiArIEZvcmUuR1JFRU4gKyAiINCf0LXRgNCy0YvQuSDRgdC/0L7RgdC+0LEg0L/QvtC40YHQutCwIikKICAgIHByaW50KEZvcmUuUkVEICsgIjIuIiArIEZvcmUuR1JFRU4gKyAiINCS0YLQvtGA0L7QuSDRgdC/0L7RgdC+0LEg0L/QvtC40YHQutCwIikKICAgIHByaW50KEZvcmUuUkVEICsgIjMuIiArIEZvcmUuR1JFRU4gKyAiINCS0YvRhdC+0LQiKQoKICAgIHByaW50KCIiKQogICAgY2hvaWNlID0gaW5wdXQoRm9yZS5SRUQgKyAi0JLRi9Cx0LXRgNC40YLQtSDRgdC/0L7RgdC+0LEg0L/QvtC40YHQutCwOiAiICsgU3R5bGUuUkVTRVRfQUxMKQoKICAgIGlmIGNob2ljZSA9PSAiMSI6CiAgICAgICAgbWFpbigpCiAgICBlbGlmIGNob2ljZSA9PSAiMiI6CiAgICAgICAgc2Vjb25kX21ldGhvZCgpCiAgICBlbGlmIGNob2ljZSA9PSAiMyI6CiAgICAgICAgZXhpdF9wcm9ncmFtKCkKICAgIGVsc2U6CiAgICAgICAgcHJpbnQoRm9yZS5SRUQgKyAi0J3QtdC60L7RgNGA0LXQutGC0L3Ri9C5INCy0YvQsdC+0YAuINCf0L7Qv9GA0L7QsdGD0LnRgtC1INGB0L3QvtCy0LAuIikKICAgICAgICB0aW1lLnNsZWVwKDEp'))
